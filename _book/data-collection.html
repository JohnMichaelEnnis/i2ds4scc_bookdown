<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Data Collection | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Data Collection | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Data Collection | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists." />
  

<meta name="author" content="John Ennis, Julien Delarue, and Thierry Worch" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="auto-report.html"/>
<link rel="next" href="data-prep.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover Art</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="preface.html"><a href="preface.html#motivation"><i class="fa fa-check"></i><b>0.1</b> Motivation</a></li>
<li class="chapter" data-level="0.2" data-path="preface.html"><a href="preface.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>0.2</b> Core principles in Sensory and Consumer Science</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="preface.html"><a href="preface.html#measuring-and-analyzing-human-responses"><i class="fa fa-check"></i><b>0.2.1</b> Measuring and analyzing human responses</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="preface.html"><a href="preface.html#how-should-sensory-and-consumer-scientists-learn-data-science"><i class="fa fa-check"></i><b>0.3</b> How should sensory and consumer scientists learn data science?</a></li>
<li class="chapter" data-level="0.4" data-path="preface.html"><a href="preface.html#caution-dont-that-everybody-does"><i class="fa fa-check"></i><b>0.4</b> Caution: Donâ€™t that everybody does</a></li>
<li class="chapter" data-level="0.5" data-path="preface.html"><a href="preface.html#example-projects"><i class="fa fa-check"></i><b>0.5</b> Example projects</a></li>
<li class="chapter" data-level="0.6" data-path="preface.html"><a href="preface.html#why-data-science"><i class="fa fa-check"></i><b>0.6</b> Why Data Science?</a></li>
<li class="chapter" data-level="0.7" data-path="preface.html"><a href="preface.html#who-should-read-this-book"><i class="fa fa-check"></i><b>0.7</b> Who Should Read This Book?</a></li>
<li class="chapter" data-level="0.8" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i><b>0.8</b> Acknowledgements</a></li>
<li class="chapter" data-level="0.9" data-path="preface.html"><a href="preface.html#how-to-contact-us"><i class="fa fa-check"></i><b>0.9</b> How to Contact Us</a></li>
</ul></li>
<li class="part"><span><b>Setting the Table</b></span></li>
<li class="chapter" data-level="1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>1</b> What is Data Science?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-science.html"><a href="data-science.html#history-and-definition"><i class="fa fa-check"></i><b>1.1</b> History and Definition</a></li>
<li class="chapter" data-level="1.2" data-path="data-science.html"><a href="data-science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>1.2</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-science.html"><a href="data-science.html#data-collection"><i class="fa fa-check"></i><b>1.2.1</b> Data Collection</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-science.html"><a href="data-science.html#data-preparation"><i class="fa fa-check"></i><b>1.2.2</b> Data Preparation</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-science.html"><a href="data-science.html#data-analysis"><i class="fa fa-check"></i><b>1.2.3</b> Data Analysis</a></li>
<li class="chapter" data-level="1.2.4" data-path="data-science.html"><a href="data-science.html#value-delivery"><i class="fa fa-check"></i><b>1.2.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-science.html"><a href="data-science.html#reproducible-research"><i class="fa fa-check"></i><b>1.3</b> Reproducible Research</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-science.html"><a href="data-science.html#principles"><i class="fa fa-check"></i><b>1.3.1</b> Principles</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-science.html"><a href="data-science.html#tools"><i class="fa fa-check"></i><b>1.3.2</b> Tools</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-science.html"><a href="data-science.html#documentation"><i class="fa fa-check"></i><b>1.3.3</b> Documentation</a></li>
<li class="chapter" data-level="1.3.4" data-path="data-science.html"><a href="data-science.html#version-control"><i class="fa fa-check"></i><b>1.3.4</b> Version control</a></li>
<li class="chapter" data-level="1.3.5" data-path="data-science.html"><a href="data-science.html#online-repositories-for-team-collaboration"><i class="fa fa-check"></i><b>1.3.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="1.3.6" data-path="data-science.html"><a href="data-science.html#building-a-code-base"><i class="fa fa-check"></i><b>1.3.6</b> Building a code base</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-science.html"><a href="data-science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>1.4</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="data-science.html"><a href="data-science.html#data-driven-decision-making"><i class="fa fa-check"></i><b>1.4.1</b> Data-Driven Decision Making</a></li>
<li class="chapter" data-level="1.4.2" data-path="data-science.html"><a href="data-science.html#standardized-data-collection"><i class="fa fa-check"></i><b>1.4.2</b> Standardized Data Collection</a></li>
<li class="chapter" data-level="1.4.3" data-path="data-science.html"><a href="data-science.html#standardized-reporting"><i class="fa fa-check"></i><b>1.4.3</b> Standardized Reporting</a></li>
<li class="chapter" data-level="1.4.4" data-path="data-science.html"><a href="data-science.html#improved-business-impact"><i class="fa fa-check"></i><b>1.4.4</b> Improved Business Impact</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="data-science.html"><a href="data-science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>1.5</b> How to Learn Data Science</a></li>
<li class="chapter" data-level="1.6" data-path="data-science.html"><a href="data-science.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.6</b> How to Use This Book</a></li>
<li class="chapter" data-level="1.7" data-path="data-science.html"><a href="data-science.html#common-data-science-tools"><i class="fa fa-check"></i><b>1.7</b> Common Data Science Tools</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidy-thoughts.html"><a href="tidy-thoughts.html"><i class="fa fa-check"></i><b>2</b> Tidy Thinking</a></li>
<li class="chapter" data-level="3" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>3</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="data-manip.html"><a href="data-manip.html#tidying-data---pre-requisite"><i class="fa fa-check"></i><b>3.0.1</b> Tidying Data - Pre-Requisite</a></li>
<li class="chapter" data-level="3.0.2" data-path="data-manip.html"><a href="data-manip.html#illustration"><i class="fa fa-check"></i><b>3.0.2</b> Illustration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>4</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-viz.html"><a href="data-viz.html#principles-1"><i class="fa fa-check"></i><b>4.1</b> Principles</a></li>
<li class="chapter" data-level="4.2" data-path="data-viz.html"><a href="data-viz.html#table-mechanics"><i class="fa fa-check"></i><b>4.2</b> Table Mechanics</a></li>
<li class="chapter" data-level="4.3" data-path="data-viz.html"><a href="data-viz.html#chart-mechanics"><i class="fa fa-check"></i><b>4.3</b> Chart Mechanics</a></li>
<li class="chapter" data-level="4.4" data-path="data-viz.html"><a href="data-viz.html#examples"><i class="fa fa-check"></i><b>4.4</b> Examples</a></li>
<li class="chapter" data-level="4.5" data-path="data-viz.html"><a href="data-viz.html#raw-material"><i class="fa fa-check"></i><b>4.5</b> Raw Material</a></li>
<li class="chapter" data-level="4.6" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Philosophy of ggplot2</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-viz.html"><a href="data-viz.html#aesthetics"><i class="fa fa-check"></i><b>4.6.1</b> aesthetics</a></li>
<li class="chapter" data-level="4.6.2" data-path="data-viz.html"><a href="data-viz.html#geom_"><i class="fa fa-check"></i><b>4.6.2</b> geom_</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-viz.html"><a href="data-viz.html#present-the-most-useful-graph"><i class="fa fa-check"></i><b>4.7</b> Present the most useful graph</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-viz.html"><a href="data-viz.html#scatter-points"><i class="fa fa-check"></i><b>4.7.1</b> Scatter points</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-viz.html"><a href="data-viz.html#line-charts"><i class="fa fa-check"></i><b>4.7.2</b> Line charts</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-viz.html"><a href="data-viz.html#bar-charts"><i class="fa fa-check"></i><b>4.7.3</b> Bar charts</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-viz.html"><a href="data-viz.html#distribution"><i class="fa fa-check"></i><b>4.7.4</b> Distribution</a></li>
<li class="chapter" data-level="4.7.5" data-path="data-viz.html"><a href="data-viz.html#text"><i class="fa fa-check"></i><b>4.7.5</b> Text</a></li>
<li class="chapter" data-level="4.7.6" data-path="data-viz.html"><a href="data-viz.html#rectangles"><i class="fa fa-check"></i><b>4.7.6</b> Rectangles</a></li>
<li class="chapter" data-level="4.7.7" data-path="data-viz.html"><a href="data-viz.html#themes-and-legend"><i class="fa fa-check"></i><b>4.7.7</b> Themes and legend</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-viz.html"><a href="data-viz.html#interesting-addition"><i class="fa fa-check"></i><b>4.8</b> Interesting addition</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="data-viz.html"><a href="data-viz.html#playing-around-with-axes"><i class="fa fa-check"></i><b>4.8.1</b> Playing around with axes</a></li>
<li class="chapter" data-level="4.8.2" data-path="data-viz.html"><a href="data-viz.html#transposing-the-plot"><i class="fa fa-check"></i><b>4.8.2</b> Transposing the plot</a></li>
<li class="chapter" data-level="4.8.3" data-path="data-viz.html"><a href="data-viz.html#splitting-plots"><i class="fa fa-check"></i><b>4.8.3</b> Splitting plots</a></li>
<li class="chapter" data-level="4.8.4" data-path="data-viz.html"><a href="data-viz.html#combining-plots"><i class="fa fa-check"></i><b>4.8.4</b> Combining plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>5</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="auto-report.html"><a href="auto-report.html#powerpoint-workflow"><i class="fa fa-check"></i><b>5.0.1</b> PowerPoint workflow</a></li>
<li class="chapter" data-level="5.0.2" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>5.0.2</b> Word</a></li>
<li class="chapter" data-level="5.0.3" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>5.0.3</b> Excel</a></li>
<li class="chapter" data-level="5.1" data-path="auto-report.html"><a href="auto-report.html#more-raw-material"><i class="fa fa-check"></i><b>5.1</b> MORE RAW MATERIAL</a></li>
<li class="chapter" data-level="5.2" data-path="auto-report.html"><a href="auto-report.html#powerpint-slide-master"><i class="fa fa-check"></i><b>5.2</b> PowerPint Slide Master</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="auto-report.html"><a href="auto-report.html#importing-the-template"><i class="fa fa-check"></i><b>5.2.1</b> Importing the Template</a></li>
<li class="chapter" data-level="5.2.2" data-path="auto-report.html"><a href="auto-report.html#creating-a-powerpoint-deck"><i class="fa fa-check"></i><b>5.2.2</b> Creating a PowerPoint Deck</a></li>
<li class="chapter" data-level="5.2.3" data-path="auto-report.html"><a href="auto-report.html#selection-pane"><i class="fa fa-check"></i><b>5.2.3</b> Selection Pane</a></li>
<li class="chapter" data-level="5.2.4" data-path="auto-report.html"><a href="auto-report.html#key-functions-read_pptxpath-layout_summaryx-layout_propertiesx-add_slidex-layout-master-on_slidex-index-slide_summaryx-index-null"><i class="fa fa-check"></i><b>5.2.4</b> Key functions: read_pptx(path), layout_summary(x), layout_properties(x), add_slide(x, layout, master), on_slide(x, index), slide_summary(x, index = NULL)</a></li>
<li class="chapter" data-level="5.2.5" data-path="auto-report.html"><a href="auto-report.html#example-code"><i class="fa fa-check"></i><b>5.2.5</b> Example Code</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="auto-report.html"><a href="auto-report.html#placeholders"><i class="fa fa-check"></i><b>5.3</b> Placeholders</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="auto-report.html"><a href="auto-report.html#placeholders-and-shapes"><i class="fa fa-check"></i><b>5.3.1</b> Placeholders and Shapes</a></li>
<li class="chapter" data-level="5.3.2" data-path="auto-report.html"><a href="auto-report.html#key-functions-ph_with"><i class="fa fa-check"></i><b>5.3.2</b> Key functions: ph_with()</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="auto-report.html"><a href="auto-report.html#text-1"><i class="fa fa-check"></i><b>5.4</b> Text</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="auto-report.html"><a href="auto-report.html#working-with-text"><i class="fa fa-check"></i><b>5.4.1</b> Working with Text</a></li>
<li class="chapter" data-level="5.4.2" data-path="auto-report.html"><a href="auto-report.html#key-functions-fpar-ftext-fp_text-block_list"><i class="fa fa-check"></i><b>5.4.2</b> Key functions: fpar(), ftext(), fp_text(), block_list()</a></li>
<li class="chapter" data-level="5.4.3" data-path="auto-report.html"><a href="auto-report.html#example-code-1"><i class="fa fa-check"></i><b>5.4.3</b> Example Code</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="auto-report.html"><a href="auto-report.html#tables"><i class="fa fa-check"></i><b>5.5</b> Tables</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="auto-report.html"><a href="auto-report.html#basic-code"><i class="fa fa-check"></i><b>5.5.1</b> Basic Code</a></li>
<li class="chapter" data-level="5.5.2" data-path="auto-report.html"><a href="auto-report.html#introduction-to-flextable"><i class="fa fa-check"></i><b>5.5.2</b> Introduction to flextable</a></li>
<li class="chapter" data-level="5.5.3" data-path="auto-report.html"><a href="auto-report.html#demonstration"><i class="fa fa-check"></i><b>5.5.3</b> Demonstration</a></li>
<li class="chapter" data-level="5.5.4" data-path="auto-report.html"><a href="auto-report.html#demonstration-output"><i class="fa fa-check"></i><b>5.5.4</b> Demonstration Output</a></li>
<li class="chapter" data-level="5.5.5" data-path="auto-report.html"><a href="auto-report.html#reformat-original-example"><i class="fa fa-check"></i><b>5.5.5</b> Reformat original example</a></li>
<li class="chapter" data-level="5.5.6" data-path="auto-report.html"><a href="auto-report.html#key-functions-flextable-align-bold-font-color-bg-height-width-border_outer-border_inner-border_inner_h-border_inner_v-autofit"><i class="fa fa-check"></i><b>5.5.6</b> key functions: flextable(), align(), bold(), font(), color(), bg(), height() &amp; width(), border_outer() &amp; border_inner() &amp; border_inner_h() &amp; border_inner_v(), autofit()</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="auto-report.html"><a href="auto-report.html#charts"><i class="fa fa-check"></i><b>5.6</b> Charts</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="auto-report.html"><a href="auto-report.html#adding-charts-as-images"><i class="fa fa-check"></i><b>5.6.1</b> Adding charts as images</a></li>
<li class="chapter" data-level="5.6.2" data-path="auto-report.html"><a href="auto-report.html#mschart-package"><i class="fa fa-check"></i><b>5.6.2</b> mschart Package</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="auto-report.html"><a href="auto-report.html#word-1"><i class="fa fa-check"></i><b>5.7</b> Word</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="auto-report.html"><a href="auto-report.html#word-documents"><i class="fa fa-check"></i><b>5.7.1</b> Word documents</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Workflow in Practice</b></span></li>
<li class="chapter" data-level="6" data-path="data-science.html"><a href="data-science.html#data-collection"><i class="fa fa-check"></i><b>6</b> Data Collection</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="data-collection.html"><a href="data-collection.html#other-details"><i class="fa fa-check"></i><b>6.2</b> Other details</a></li>
<li class="chapter" data-level="6.3" data-path="data-collection.html"><a href="data-collection.html#importing-data-to-r"><i class="fa fa-check"></i><b>6.3</b> Importing Data to R</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>6.3.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="6.3.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>6.3.2</b> Importing Unstructured Excel File</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>7</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-prep.html"><a href="data-prep.html#inspect-1"><i class="fa fa-check"></i><b>7.1</b> Inspect</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>7.1.1</b> Data Inspection</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>7.1.2</b> Design Inspection</a></li>
<li class="chapter" data-level="7.1.3" data-path="data-prep.html"><a href="data-prep.html#missing-data-inspection"><i class="fa fa-check"></i><b>7.1.3</b> Missing Data Inspection</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-prep.html"><a href="data-prep.html#clean-1"><i class="fa fa-check"></i><b>7.2</b> Clean</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="data-prep.html"><a href="data-prep.html#renaming-variables"><i class="fa fa-check"></i><b>7.2.1</b> Renaming Variables</a></li>
<li class="chapter" data-level="7.2.2" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>7.2.2</b> Handling Data Type</a></li>
<li class="chapter" data-level="7.2.3" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>7.2.3</b> Converting between Types</a></li>
<li class="chapter" data-level="7.2.4" data-path="data-prep.html"><a href="data-prep.html#handling-missing-values"><i class="fa fa-check"></i><b>7.2.4</b> Handling Missing Values</a></li>
<li class="chapter" data-level="7.2.5" data-path="data-prep.html"><a href="data-prep.html#restructuring-data"><i class="fa fa-check"></i><b>7.2.5</b> Restructuring Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-science.html"><a href="data-science.html#data-analysis"><i class="fa fa-check"></i><b>8</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>8.1</b> Transformation</a></li>
<li class="chapter" data-level="8.2" data-path="data-analysis.html"><a href="data-analysis.html#exploration"><i class="fa fa-check"></i><b>8.2</b> Exploration</a></li>
<li class="chapter" data-level="8.3" data-path="data-analysis.html"><a href="data-analysis.html#modeling"><i class="fa fa-check"></i><b>8.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-science.html"><a href="data-science.html#value-delivery"><i class="fa fa-check"></i><b>9</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="9.1" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>9.1</b> Design principles</a></li>
<li class="chapter" data-level="9.2" data-path="value-delivery.html"><a href="value-delivery.html#scientific-inquiry-vs-storytelling"><i class="fa fa-check"></i><b>9.2</b> Scientific inquiry vs storytelling</a></li>
<li class="chapter" data-level="9.3" data-path="value-delivery.html"><a href="value-delivery.html#research-reformulation"><i class="fa fa-check"></i><b>9.3</b> Research reformulation</a></li>
<li class="chapter" data-level="9.4" data-path="value-delivery.html"><a href="value-delivery.html#interactive-reporting"><i class="fa fa-check"></i><b>9.4</b> Interactive reporting</a></li>
<li class="chapter" data-level="9.5" data-path="value-delivery.html"><a href="value-delivery.html#excel-1"><i class="fa fa-check"></i><b>9.5</b> Excel</a></li>
<li class="chapter" data-level="9.6" data-path="value-delivery.html"><a href="value-delivery.html#word-2"><i class="fa fa-check"></i><b>9.6</b> Word</a></li>
<li class="chapter" data-level="9.7" data-path="value-delivery.html"><a href="value-delivery.html#powerpoint"><i class="fa fa-check"></i><b>9.7</b> PowerPoint</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="value-delivery.html"><a href="value-delivery.html#charts-1"><i class="fa fa-check"></i><b>9.7.1</b> Charts</a></li>
<li class="chapter" data-level="9.7.2" data-path="value-delivery.html"><a href="value-delivery.html#tables-1"><i class="fa fa-check"></i><b>9.7.2</b> Tables</a></li>
<li class="chapter" data-level="9.7.3" data-path="value-delivery.html"><a href="value-delivery.html#bullet-points"><i class="fa fa-check"></i><b>9.7.3</b> Bullet Points</a></li>
<li class="chapter" data-level="9.7.4" data-path="value-delivery.html"><a href="value-delivery.html#images"><i class="fa fa-check"></i><b>9.7.4</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="value-delivery.html"><a href="value-delivery.html#html"><i class="fa fa-check"></i><b>9.8</b> HTML</a></li>
</ul></li>
<li class="part"><span><b>Additional Topics</b></span></li>
<li class="chapter" data-level="10" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>10</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="10.1" data-path="machine-learning.html"><a href="machine-learning.html#concepts-and-general-workflow-trainingtest"><i class="fa fa-check"></i><b>10.1</b> Concepts and general workflow (training/test)</a></li>
<li class="chapter" data-level="10.2" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>10.2</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="machine-learning.html"><a href="machine-learning.html#cluster-analysis"><i class="fa fa-check"></i><b>10.2.1</b> Cluster analysis</a></li>
<li class="chapter" data-level="10.2.2" data-path="machine-learning.html"><a href="machine-learning.html#factor-analysis"><i class="fa fa-check"></i><b>10.2.2</b> Factor analysis</a></li>
<li class="chapter" data-level="10.2.3" data-path="machine-learning.html"><a href="machine-learning.html#principle-components-analysis"><i class="fa fa-check"></i><b>10.2.3</b> Principle components analysis</a></li>
<li class="chapter" data-level="10.2.4" data-path="machine-learning.html"><a href="machine-learning.html#t-sne"><i class="fa fa-check"></i><b>10.2.4</b> t-SNE</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="machine-learning.html"><a href="machine-learning.html#semisupervised-learning"><i class="fa fa-check"></i><b>10.3</b> Semisupervised learning</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="machine-learning.html"><a href="machine-learning.html#pls-regression"><i class="fa fa-check"></i><b>10.3.1</b> PLS regression</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>10.4</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="machine-learning.html"><a href="machine-learning.html#regression"><i class="fa fa-check"></i><b>10.4.1</b> Regression</a></li>
<li class="chapter" data-level="10.4.2" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>10.4.2</b> K-nearest neighbors</a></li>
<li class="chapter" data-level="10.4.3" data-path="machine-learning.html"><a href="machine-learning.html#decision-trees"><i class="fa fa-check"></i><b>10.4.3</b> Decision trees</a></li>
<li class="chapter" data-level="10.4.4" data-path="machine-learning.html"><a href="machine-learning.html#black-boxes"><i class="fa fa-check"></i><b>10.4.4</b> Black boxes</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="machine-learning.html"><a href="machine-learning.html#predictive-modeling"><i class="fa fa-check"></i><b>10.5</b> Predictive modeling</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="machine-learning.html"><a href="machine-learning.html#predicting-sensory-profiles-from-instrumental-data"><i class="fa fa-check"></i><b>10.5.1</b> Predicting sensory profiles from instrumental data</a></li>
<li class="chapter" data-level="10.5.2" data-path="machine-learning.html"><a href="machine-learning.html#predicting-consumer-response-from-sensory-profiles"><i class="fa fa-check"></i><b>10.5.2</b> Predicting consumer response from sensory profiles</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="machine-learning.html"><a href="machine-learning.html#interpretability"><i class="fa fa-check"></i><b>10.6</b> Interpretability</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="machine-learning.html"><a href="machine-learning.html#lime"><i class="fa fa-check"></i><b>10.6.1</b> LIME</a></li>
<li class="chapter" data-level="10.6.2" data-path="machine-learning.html"><a href="machine-learning.html#dalex"><i class="fa fa-check"></i><b>10.6.2</b> DALEX</a></li>
<li class="chapter" data-level="10.6.3" data-path="machine-learning.html"><a href="machine-learning.html#iml"><i class="fa fa-check"></i><b>10.6.3</b> IML</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="machine-learning.html"><a href="machine-learning.html#cmputer-vision"><i class="fa fa-check"></i><b>10.7</b> Cmputer vision</a></li>
<li class="chapter" data-level="10.8" data-path="machine-learning.html"><a href="machine-learning.html#other-methods-and-resources"><i class="fa fa-check"></i><b>10.8</b> Other methods and resources</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="machine-learning.html"><a href="machine-learning.html#data-prep-1"><i class="fa fa-check"></i><b>10.8.1</b> Data Prep</a></li>
<li class="chapter" data-level="10.8.2" data-path="machine-learning.html"><a href="machine-learning.html#classification-code"><i class="fa fa-check"></i><b>10.8.2</b> Classification Code</a></li>
<li class="chapter" data-level="10.8.3" data-path="machine-learning.html"><a href="machine-learning.html#regression-code"><i class="fa fa-check"></i><b>10.8.3</b> Regression Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>11</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="text-analysis.html"><a href="text-analysis.html#data-import"><i class="fa fa-check"></i><b>11.1</b> Data import</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="text-analysis.html"><a href="text-analysis.html#data-sources"><i class="fa fa-check"></i><b>11.1.1</b> Data sources</a></li>
<li class="chapter" data-level="11.1.2" data-path="text-analysis.html"><a href="text-analysis.html#tokenizing"><i class="fa fa-check"></i><b>11.1.2</b> Tokenizing</a></li>
<li class="chapter" data-level="11.1.3" data-path="text-analysis.html"><a href="text-analysis.html#lemmatization-stemming-and-stop-word-removal"><i class="fa fa-check"></i><b>11.1.3</b> Lemmatization, stemming, and stop word removal</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="text-analysis.html"><a href="text-analysis.html#analysis"><i class="fa fa-check"></i><b>11.2</b> Analysis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="text-analysis.html"><a href="text-analysis.html#frequency-counts-and-summary-statistics"><i class="fa fa-check"></i><b>11.2.1</b> Frequency counts and summary statistics</a></li>
<li class="chapter" data-level="11.2.2" data-path="text-analysis.html"><a href="text-analysis.html#word-clouds"><i class="fa fa-check"></i><b>11.2.2</b> Word clouds</a></li>
<li class="chapter" data-level="11.2.3" data-path="text-analysis.html"><a href="text-analysis.html#contrast-plots"><i class="fa fa-check"></i><b>11.2.3</b> Contrast plots</a></li>
<li class="chapter" data-level="11.2.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>11.2.4</b> Sentiment analysis</a></li>
<li class="chapter" data-level="11.2.5" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-and-word-graphs"><i class="fa fa-check"></i><b>11.2.5</b> Bigrams and word graphs</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="text-analysis.html"><a href="text-analysis.html#raw-material-1"><i class="fa fa-check"></i><b>11.3</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="text-analysis.html"><a href="text-analysis.html#statistical-entities"><i class="fa fa-check"></i><b>11.3.1</b> Statistical entities</a></li>
<li class="chapter" data-level="11.3.2" data-path="text-analysis.html"><a href="text-analysis.html#analysis-of-frequencies-and-term-frequency-document"><i class="fa fa-check"></i><b>11.3.2</b> Analysis of Frequencies and term-frequency document</a></li>
<li class="chapter" data-level="11.3.3" data-path="text-analysis.html"><a href="text-analysis.html#futher-analysis-of-the-words"><i class="fa fa-check"></i><b>11.3.3</b> Futher Analysis of the words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pipelines.html"><a href="pipelines.html"><i class="fa fa-check"></i><b>12</b> Pipelines</a></li>
<li class="chapter" data-level="13" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>13</b> Whatâ€™s Next?</a>
<ul>
<li class="chapter" data-level="13.1" data-path="next-steps.html"><a href="next-steps.html#shiny-1"><i class="fa fa-check"></i><b>13.1</b> Shiny</a></li>
<li class="chapter" data-level="13.2" data-path="next-steps.html"><a href="next-steps.html#graph-databases"><i class="fa fa-check"></i><b>13.2</b> Graph Databases</a></li>
<li class="chapter" data-level="13.3" data-path="next-steps.html"><a href="next-steps.html#sensory-analysis-in-r"><i class="fa fa-check"></i><b>13.3</b> Sensory Analysis in R</a></li>
<li class="chapter" data-level="13.4" data-path="next-steps.html"><a href="next-steps.html#learning-resources"><i class="fa fa-check"></i><b>13.4</b> Learning Resources</a></li>
<li class="chapter" data-level="13.5" data-path="next-steps.html"><a href="next-steps.html#python"><i class="fa fa-check"></i><b>13.5</b> Python</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>A</b> Getting Started in R</a>
<ul>
<li class="chapter" data-level="A.1" data-path="start-R.html"><a href="start-R.html#r"><i class="fa fa-check"></i><b>A.1</b> R</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="start-R.html"><a href="start-R.html#why-learn-a-programming-language"><i class="fa fa-check"></i><b>A.1.1</b> Why Learn a Programming Language?</a></li>
<li class="chapter" data-level="A.1.2" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>A.1.2</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="start-R.html"><a href="start-R.html#why-r-1"><i class="fa fa-check"></i><b>A.2</b> Why R?</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-r"><i class="fa fa-check"></i><b>A.2.1</b> Steps to Install R</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>A.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-rstudio"><i class="fa fa-check"></i><b>A.3.1</b> Steps to Install RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="start-R.html"><a href="start-R.html#create-a-local-project"><i class="fa fa-check"></i><b>A.3.2</b> Create a Local Project</a></li>
<li class="chapter" data-level="A.3.3" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>A.3.3</b> Install and Load Packages</a></li>
<li class="chapter" data-level="A.3.4" data-path="start-R.html"><a href="start-R.html#run-sample-code"><i class="fa fa-check"></i><b>A.3.4</b> Run Sample Code</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>A.4</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>A.4.1</b> Git</a></li>
<li class="chapter" data-level="A.4.2" data-path="start-R.html"><a href="start-R.html#github-1"><i class="fa fa-check"></i><b>A.4.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="start-R.html"><a href="start-R.html#raw-material-2"><i class="fa fa-check"></i><b>A.5</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="start-R.html"><a href="start-R.html#principles-2"><i class="fa fa-check"></i><b>A.5.1</b> Principles</a></li>
<li class="chapter" data-level="A.5.2" data-path="start-R.html"><a href="start-R.html#tools-1"><i class="fa fa-check"></i><b>A.5.2</b> Tools</a></li>
<li class="chapter" data-level="A.5.3" data-path="start-R.html"><a href="start-R.html#documentation-1"><i class="fa fa-check"></i><b>A.5.3</b> Documentation</a></li>
<li class="chapter" data-level="A.5.4" data-path="start-R.html"><a href="start-R.html#version-control-1"><i class="fa fa-check"></i><b>A.5.4</b> Version control</a></li>
<li class="chapter" data-level="A.5.5" data-path="start-R.html"><a href="start-R.html#online-repositories-for-team-collaboration-1"><i class="fa fa-check"></i><b>A.5.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="A.5.6" data-path="start-R.html"><a href="start-R.html#building-a-code-base-1"><i class="fa fa-check"></i><b>A.5.6</b> Building a code base</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-collection" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Data Collection</h1>
<div id="background" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Background</h2>
</div>
<div id="other-details" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Other details</h2>
</div>
<div id="importing-data-to-r" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Importing Data to R</h2>
<p>To analyze data, one need <em>data</em>. If this data is already available in R, then the analysis can be performed directly. However, in much cases, the data is stored outside the R environment, and needs to be imported.</p>
<p>In practice, the data might be stored in as many format as one can imagine, whether it ends up being a fairly common solution (.txt file, .csv file, or .xls/.xlsx file), or software specific (e.g.Â Stata, SPSS, etc.).
Since it is very common to store the data in Excel spreadsheets (.xlsx) due to its simplicity, the emphasis is on this solution. Fortunately, most generalities presented for Excel files also apply to other formats through <code>base::read.table()</code> for .txt files, <code>base::read.csv()</code> and <code>base::read.csv2()</code> for .csv files, or through the <code>{read}</code> package (which is part of the <code>{tidyverse}</code>).</p>
<p>For other (less common) formats, the reader can find packages that would allow importing their files into R. Particular interest can be given to the package <code>{rio}</code> (<em>rio</em> stands for <em>R</em> <em>I</em>nput and <em>O</em>utput) which provides an easy solution that 1. can handle a large variety of files, 2. can actually guess the type of file it is, and 3. provides tools to import, export, and convert almost any type of data format, including .csv, .xls and .xlsx, or data from other statistical software such as SAS (.sas7bdat and .xpt), SPSS (.sav and .por), or Stata (.dta). As an alternative, the package <code>{foreign}</code> provides functions that allow importing data stored from other statistical software (incl.Â Minitab, S, SAS, Stata, SPSS, etc.)</p>
<p>Although Excel is most likely one of the most popular way of storing data, there are no <code>{base}</code> functions that allow importing such files easily. Fortunately, many packages have been developed in that purpose, including <code>{XLConnect}</code>, <code>{xlsx}</code>, <code>{gdata}</code>, and <code>{readxl}</code>. Due to its convenience and speed of execution, we will be using <code>{readxl}</code> here.</p>
<div id="importing-structured-excel-file" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Importing Structured Excel File</h3>
<p>First, letâ€™s import the <em>Sensory Profile.xlsx</em> workbook using the <code>readxl::read_xlsx()</code> file, by informing as parameter the location of the file (informed in <code>file_path</code> using the package <code>{here}</code>) and the <code>sheet</code> we want to read from.</p>
<p>This file is called <em>structured</em> as all the relevant information is already stored in the same sheet in a structured way. In other words, no decoding is required here, and there are no â€˜unexpectedâ€™ rows or columns (e.g.Â empty lines, or lines with additional information regarding the data but that is not data):</p>
<ul>
<li>The first row within the <em>Data</em> sheet of <em>Sensory Profile.xlsx</em> contains the headers,<br />
</li>
<li>From the second row onwards, only data is being stored.</li>
</ul>
<p>Since this data will be used for some analyses, it is assigned data to an R object called <code>sensory</code>.</p>
<p>To ensure that the importation went well, we print <code>sensory</code> to see how it looks like. Since <code>{readxl}</code> has been developed by Hadley Wickham and colleagues, its functions follow the <code>{tidyverse}</code> principles and the dataset thus imported is a <code>tibble</code>. Letâ€™s take advantage of the printing properties of a <code>tibble</code> to evaluate <code>sensory</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data-collection.html#cb36-1" aria-hidden="true" tabindex="-1"></a>sensory</span></code></pre></div>
<p><code>sensory</code> is a tibble with 99 rows and 35 columns that includes the <code>Judge</code> information (first column, defined as character), the <code>Product</code> information (second and third columns, defined as character), and the sensory attributes (fourth column onward, defined as numerical or <code>dbl</code>).</p>
</div>
<div id="importing-unstructured-excel-file" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Importing Unstructured Excel File</h3>
<p>In some cases, the dataset is not so well organized/structured, and may need to be <em>decoded</em>. This is the case for the workbook entitled <em>TFEQ.xlsx</em>. For this file:</p>
<ul>
<li>The variablesâ€™ name have been coded and their corresponding names (together with some other valuable information we will be using in the next chapter) are stored in a different sheet entitled <em>Variables</em>;</li>
<li>The different levels of each variable (including their code and corresponding names) are stored in another sheet entitled <em>Levels</em>.</li>
</ul>
<p>To import and decode this dataset, multiple steps are required:</p>
<ul>
<li>Import the variablesâ€™ name only;</li>
<li>Import the information regarding the levels;</li>
<li>Import the dataset without the first line of header, but by providing the correct names obtained in the first step;</li>
<li>Decode each question (when needed) by replacing the numerical code by their corresponding labels.</li>
</ul>
<p>Letâ€™s start with importing the variablesâ€™ names from <em>TFEQ.xlsx</em> (sheet <em>Variables</em>)</p>
<p>In a similar way, letâ€™s import the information related to the levels of each variable, stored in the <em>Levels</em> sheet.
A deeper look at the <em>Levels</em> sheet shows that only the coded names of the variables are available. In order to include the final names, <code>var_names</code> is joined (using <code>inner_join</code>).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-collection.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-2"><a href="data-collection.html#cb37-2" aria-hidden="true" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Levels&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="data-collection.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(var_names, Code, Name), <span class="at">by=</span><span class="fu">c</span>(<span class="at">Question=</span><span class="st">&quot;Code&quot;</span>))</span>
<span id="cb37-4"><a href="data-collection.html#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="data-collection.html#cb37-5" aria-hidden="true" tabindex="-1"></a>var_labels</span></code></pre></div>
<p><strong>Note</strong>: In some cases, this information is directly available in the dataset as sub-header: A solution is then to import the first rows of the dataset that contain this information using the parameter <code>n_max</code> from `readxl::read_xlsx``. For each variable (when information is available), store that information as a list of tables that contains the code and their corresponding label.</p>
<!-- **THIS SECTION BELOW MIGHT NEED TO GET PASSED ON TO THE EXERCISE**

Since most likely this system of coding follow a fixed pattern, we strongly recommend the use of `{tidytext}` and its function `unnest_tokens()`.
For example, let's imagine that the our information is structured as *code1=label1,code2=label2,...* (e.g. *0=No,1=Yes*). In such case, first use `unnest_tokens()` to split this string by ','. This creates a tibble with as many rows as there are *code=label* and one column. Next, split this column into two columns using `separate()` and `sep="="`.

**(PREVIOUS PART) TO BE GIVEN AS AN EXAMPLE/EXERCISE** -->
<p>Finally, the dataset (<em>Data</em>) is imported by substituting the coded names with their corresponding names.
This process can be done by skipping reading the first row of the dataset that contains the coded header (<code>skip=1</code>), and by passing <code>Var_names</code> as header or column names (after ensuring that the namesâ€™ sequence perfectly match across the two tables!).</p>
<p>The data has now the proper header, however each variable is still coded numerically. The steps to convert the numerical values with their corresponding labels is shown in Section <a href="data-prep.html#data-prep">7</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="auto-report.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-prep.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["i2ds4scc_bookdown.pdf", "i2ds4scc_bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
